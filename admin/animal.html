<!DOCTYPE html>
<html lang="en">
<head>
  <title>Animal Park</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="../css/main.css">
  
</head>
<body>

<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand" href="#">Animal Park</a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Logout</a></li>
      </ul>
    </div>
  </div>
</nav>
  
<div class="container-fluid text-center">    
  <div class="row content">
    <div class="col-sm-2 sidenav">
      <p><a href="dashboard.html">Dashboard</a></p>
      <p><a href="animal.html">Animal</a></p>
      
      
    </div>
     <div class="col-sm-10 text-left"> 
        <h3>Animal Section </h3>
        <hr />
       <!-- Button trigger modal -->
<button type="button" class="btn btn-success" data-toggle="modal" data-target="#addnewanimal">
  Add New Animal 
</button>
        <p> </p>
     <div class="panel panel-default">
        <div class="panel-heading">
            List
        </div>

        <div class="panel-body table-responsive">
            <table class="table table-bordered table-striped {{ count($patients) > 0 ? 'datatable' : '' }} dt-select">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Scientific Name</th>
                        <th>Species</th>
                        <th>likes</th>                                           
                        <th>&nbsp;</th>
                        

                    </tr>
                </thead>                 
                
                <tbody id='animalTable'>
                   
                </tbody>
            </table>
        </div>
    </div>

     </div>
 </div>
</div>

<footer class="container-fluid text-center">
  <p>Decagon&copy;2019</p>
</footer>
<!-- Modal -->
<div class="modal fade" id="addnewanimal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="animalModal">Create Animal</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
          <form >
            <div class="row">             
                <div class="col-xs-6">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Name" id="name">
                    </div>
                </div>
                <div class="col-xs-6">
                   <div class="form-group">
                      <input type="text" class="form-control" placeholder="Scientific Name" id="science">
                    </div>
                </div>              
                <div class="col-xs-12">
                    <div class="form-group">
                      <textarea class="form-control" id="textarea1" rows="3" placeholder="description"></textarea>
                    </div>
                </div>
                <div class="col-xs-6">
                    <div class="form-group">
                        <select class="form-control" id="species">
                            <option>Mammalia</option>
                            <option>Aves</option>
                            <option>Amphibia</option>
                            <option>Reptilia</option>
                            <option>Fish</option>
                        </select>
                    </div>
                </div>
                <div class="col-xs-6">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Image Url" id="image">
                    </div>
                </div>
             
            </div>
        </form>
        
      </div>
      <div class="modal-footer">
         <button type="button" class="btn btn-primary" id="create">Create</button>
      </div>
    </div>
  </div>
</div>



<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
<script src="../plugins/datatables/jquery.dataTables.min.js"></script>

<script>
$(document).ready(function(){
// upload data in table
$.ajax({	
              
	  url:' http://localhost:3000/animals',
	  method: 'GET',
	  dataType: 'json',
	  success:function(data) {
          console.log(data);
          data.forEach(function(currentValue, index){
               var txt = "<tr><td>"+currentValue.name+"</td><td>"+currentValue.scientificname+"</td><td>"+currentValue.species+"</td><td>"+currentValue.likes+"</td><td><a href='view.html?"+currentValue.id+"' class='btn btn-xs btn-danger'>view</a>  <a href='edit.html?"+currentValue.id+"' class='btn btn-xs btn-warning'>Edit</a> <a href='#' class='btn btn-xs btn-info' name='"+currentValue.id+"'>Delete</a></td></tr>";
                
               $('#animalTable').append(txt);
               console.log(currentValue);
        
       });
	}				
 });	


   $("#create").on('click', function(){
      var formData = {
            'name'              : $('#name').val(),
            'scientificname'    : $('#science').val(),
            'description'    : $('#textarea1').val(),
            'species'    : $('#species').val(),
            'likes'    : 0,
        };
      $.ajax({	
              
          url:' http://localhost:3000/animals',
          type:'POST',
            data:formData,
          dataType: 'json',
          success:function(data) {
                console.log(data);
                $('#animalModal').modal('hide')
                location.reload();
                
          }				
        }); 
       
      });

   

 });

 $(document).on("click", '.btn-info', function(event){
        event.preventDefault();
        confirm('Are You Sure You Want Delete It');
        var id = $(this).attr("name");
        console.log(id );
        $.ajax({
            url: '  http://localhost:3000/animals/'+id,
            type:'DELETE',
            success : function(data){
                alert('deleted successfully');
                location.reload(true);
            }
        });
    }); 

</script>


</body>
</html>
